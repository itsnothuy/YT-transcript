# Workaround: Manual Transcript Download (Until Extension Fix)

Since YouTube is returning empty responses to programmatic requests, here's how to get transcripts manually (the method you were using):

---

## üéØ Quick Method (Using Browser Network Tab)

### Step 1: Open YouTube Video
Navigate to any YouTube video with captions.

### Step 2: Open DevTools
- **Mac:** Cmd + Option + I
- **Windows/Linux:** F12 or Ctrl + Shift + I

### Step 3: Go to Network Tab
1. Click the **Network** tab in DevTools
2. Click the **üîç filter icon** or search box
3. Type: `timedtext`

### Step 4: Enable Captions
Click the **CC** (closed captions) button on the YouTube player to turn on captions.

### Step 5: Find the Request
You should see one or more requests like:
```
timedtext?v=VIDEO_ID&...&fmt=json3
```

### Step 6: Copy the URL
1. **Right-click** on the timedtext request
2. Select **Copy** ‚Üí **Copy URL**

Example URL:
```
https://www.youtube.com/api/timedtext?v=osYjpsUx_OU&ei=ypx6aYDZGMGCpt8Ps-nXwAk&caps=asr&opi=112496729&exp=xpe&xoaf=4&xowf=1&xospf=1&hl=en&ip=0.0.0.0&ipbits=0&expire=1769668410&sparams=ip%2Cipbits%2Cexpire%2Cv%2Cei%2Ccaps%2Copi%2Cexp%2Cxoaf&signature=035503CA41011B777C6E0EE1578160CC9CAD5DF1.56973FD2A4CD1E296007FE46AB190FC36B395DEE&key=yt8&kind=asr&lang=en&variant=ec&potc=1&pot=MlScWoDLR82l8pxnM9R_7_pvxuD0Wr2pHarXaEoFdtwVDP6-V62J-WdnggJMDnczhWYBZjGii5tA9wZrFETQYPAD2sJ4zSAOhJbWNxaboWuC5Hdfc6M%3D&fmt=json3&xorb=2&xobt=3&xovt=3&cbrand=apple&cbr=Chrome&cbrver=142.0.0.0&c=WEB&cver=2.20260128.01.00&cplayer=UNIPLAYER&cos=Macintosh&cosver=10_15_7&cplatform=DESKTOP
```

### Step 7: Save as .txt File
1. Open a new browser tab
2. Paste the URL in the address bar
3. Press Enter
4. You'll see JSON like: `{"events":[...]}`
5. **Right-click** on the page ‚Üí **Save As...**
6. Save as `VideoName.txt`

### Step 8: Convert to Transcript
Now use your Python script:

```bash
cd /Users/tranhuy/Desktop/Code/transcript
python3 extract_transcript.py /path/to/VideoName.txt
```

The script will:
- Parse the JSON3 format
- Extract all `events[].segs[].utf8` fields
- Save verbatim transcript as `VideoName.txt`

---

## ü§ñ Semi-Automated Method (Using curl)

### Step 1-6: Same as above (get the URL from Network tab)

### Step 7: Use curl Instead
```bash
curl "PASTE_URL_HERE" -o transcript.json3.txt
```

### Step 8: Run Python Script
```bash
python3 extract_transcript.py transcript.json3.txt
```

---

## üìã Batch Processing Multiple Videos

Create a shell script:

```bash
#!/bin/bash
# download_transcripts.sh

# Array of URLs (copy from Network tab)
urls=(
  "https://www.youtube.com/api/timedtext?v=VIDEO1&...&fmt=json3"
  "https://www.youtube.com/api/timedtext?v=VIDEO2&...&fmt=json3"
  "https://www.youtube.com/api/timedtext?v=VIDEO3&...&fmt=json3"
)

# Download each
for i in "${!urls[@]}"; do
  curl "${urls[$i]}" -o "video_${i}.json3.txt"
  python3 extract_transcript.py "video_${i}.json3.txt"
done
```

---

## ‚ö†Ô∏è Important Notes

### Token Expiration
The URLs from Network tab expire after **1-2 hours**. The `expire` parameter shows when:
```
&expire=1769668410
```

To check if expired:
```bash
date -r 1769668410  # On Mac
# or
date -d @1769668410  # On Linux
```

If expired, you'll get:
```json
{"error":"Token expired"}
```

**Solution:** Go back to YouTube, open DevTools, turn captions on/off to generate a fresh URL.

### Rate Limiting
YouTube may rate-limit if you:
- Download too many transcripts in a short time
- Use the same token multiple times
- Make requests from multiple IPs

**Solution:** Wait a few minutes between bulk downloads.

---

## üîÆ Future Extension Fix Ideas

The extension needs to replicate the **exact headers** YouTube sends:

```javascript
fetch(url, {
  headers: {
    'Accept': '*/*',
    'Accept-Language': 'en-US,en;q=0.9',
    'Referer': 'https://www.youtube.com/watch?v=VIDEO_ID',
    'Sec-Fetch-Dest': 'empty',
    'Sec-Fetch-Mode': 'cors',
    'Sec-Fetch-Site': 'same-origin',
    'User-Agent': navigator.userAgent,
    'X-Client-Data': '...',  // YouTube-specific
    'X-YouTube-Client-Name': '1',
    'X-YouTube-Client-Version': '2.20260128.01.00'
  }
})
```

Or use `chrome.webRequest` API to intercept YouTube's own caption requests.

---

## üí° Why This Works But Extension Doesn't

When you manually copy from Network tab:
1. ‚úÖ URL was generated by YouTube's own player
2. ‚úÖ Includes all required authentication tokens
3. ‚úÖ Tokens are validated against your browser session
4. ‚úÖ When you paste in browser/curl, cookies are sent automatically

When extension tries:
1. ‚ùå URL is extracted from `ytInitialPlayerResponse` (correct)
2. ‚ùå But fetch() from injected script lacks proper headers
3. ‚ùå YouTube sees request doesn't match expected pattern
4. ‚ùå Returns 200 OK but empty body (anti-bot protection)

**The solution:** Extension needs to either:
- Copy exact headers from real requests
- Or intercept real requests and reuse the data
- Or use YouTube Data API v3 (official but requires API key)

---

## üìä Comparison

| Method | Speed | Reliability | Effort |
|--------|-------|-------------|--------|
| **Manual Network Tab** | Slow | 100% | High |
| **curl + Script** | Medium | 100% | Medium |
| **Extension (if fixed)** | Fast | 90% | Low |
| **YouTube Data API** | Fast | 95% | Medium (setup) |

For now, stick with **Manual Network Tab + Python script** until the extension is fixed.

---

## üéì Learning Resource

Understanding the Network tab method helps you:
1. See exactly what data YouTube sends
2. Debug API issues
3. Understand web authentication flows
4. Build better extensions

This is a valuable skill for web development!
